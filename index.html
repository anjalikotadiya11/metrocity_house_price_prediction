<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Lil' Homie - House Price Estimator</title>
  
  <!-- Fonts & CSS -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  
  <!-- Linking directly to style.css since it is in the same folder -->
  <link rel="stylesheet" href="style.css"> 
</head>
<body>

  <!-- Decorative Background Blobs -->
  <div class="bg-blob blob-1"></div>
  <div class="bg-blob blob-2"></div>

  <div class="app-container">
    <h1 class="app-title">Lil' Homie</h1>
    <p class="app-subtitle">Superb House Price Estimator for Indian Metros</p>
    
    <form id="predictionForm">
      <div class="row g-3">
        
        <!-- Location & Status -->
        <div class="col-md-6">
          <label class="form-label">City</label>
          <select class="form-select" id="city" required>
            <option value="" selected disabled>Select Location</option>
            <option value="Mumbai">Mumbai</option>
            <option value="Bangalore">Bangalore</option>
            <option value="Chennai">Chennai</option>
            <option value="Delhi">Delhi</option>
            <option value="Pune">Pune</option>
            <option value="Hyderabad">Hyderabad</option>
            <option value="Ahmedabad">Ahmedabad</option>
            <option value="Kolkata">Kolkata</option>
          </select>
        </div>
        
        <div class="col-md-6">
          <label class="form-label">Property Status</label>
          <select class="form-select" id="status">
            <option value="Ready to Move">Ready to Move</option>
            <option value="Under Construction">Under Construction</option>
          </select>
        </div>

        <!-- Core Area -->
        <div class="col-md-12">
          <label class="form-label">Total Area (sq. ft.)</label>
          <input type="number" class="form-control" id="area" placeholder="e.g. 1250" min="100" required>
        </div>

        <!-- Configuration -->
        <div class="col-md-6">
          <label class="form-label">Bedrooms (BHK)</label>
          <input type="number" class="form-control" id="beds" placeholder="2" min="1" required>
        </div>
        <div class="col-md-6">
          <label class="form-label">Bathrooms</label>
          <input type="number" class="form-control" id="baths" placeholder="2" min="1" required>
        </div>

        <!-- Amenities -->
        <div class="col-md-6">
          <label class="form-label">Balconies</label>
          <input type="number" class="form-control" id="balcony" placeholder="1" min="0">
        </div>
        <div class="col-md-6">
          <label class="form-label">Parking Spots</label>
          <input type="number" class="form-control" id="parking" placeholder="1" min="0">
        </div>

        <!-- Floor Details (Specifically Requested) -->
        <div class="col-md-6">
          <label class="form-label">Floor Number</label>
          <input type="number" class="form-control" id="floor" placeholder="5" min="0">
        </div>
        <div class="col-md-6">
          <label class="form-label">Total Floors</label>
          <input type="number" class="form-control" id="total_floors" placeholder="15" min="1">
        </div>
      </div>

      <button type="submit" class="btn btn-predict">Estimate Price</button>
    </form>

    <!-- Result Section -->
    <div id="resultCard" class="result-box" style="display: none;">
      <p class="text-muted mb-1">Estimated Market Value</p>
      <h2 id="priceText" class="result-price"></h2>
    </div>
  </div>

  <script>
    document.getElementById('predictionForm').addEventListener('submit', async function(e) {
      e.preventDefault();
      
      const formData = {
        city: document.getElementById('city').value,
        status: document.getElementById('status').value,
        area_sqft: document.getElementById('area').value,
        beds: document.getElementById('beds').value,
        baths: document.getElementById('baths').value,
        balcony: document.getElementById('balcony').value || 0,
        parking: document.getElementById('parking').value || 0,
        floor: document.getElementById('floor').value || 0,
        total_floors: document.getElementById('total_floors').value || 0
      };

      try {
        const response = await fetch('/predict', {
          method: 'POST',
          headers: {'Content-Type': 'application/json'},
          body: JSON.stringify(formData)
        });

        const result = await response.json();
        
        const resultDiv = document.getElementById('resultCard');
        const priceText = document.getElementById('priceText');
        
        // Force display block to ensure it shows up
        resultDiv.style.display = 'block'; 

        if (result.predicted_price) {
            const price = new Intl.NumberFormat('en-IN', {
              style: 'currency', currency: 'INR', maximumFractionDigits: 0
            }).format(result.predicted_price);
            
            priceText.innerText = price;
            priceText.style.color = "#006064";
        } else {
            priceText.innerText = "Error: " + (result.error || "Unknown error");
            priceText.style.color = "#d32f2f";
        }
        
      } catch (error) {
        console.error("Fetch Error:", error);
        alert("Connection Error! Check console for details.");
      }
    });
  </script>
</body>
</html>